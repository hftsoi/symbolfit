.. container:: cell markdown
   :name: 88b4c9b6-6e92-494e-ad97-bfe7aeaaf6c5

   .. rubric:: Toy Dataset 2a
      :name: toy-dataset-2a

.. container:: cell code
   :name: 95ae43f4-d947-4c53-a133-73b163369e3d

   .. code:: python

      import numpy as np

      # each element contains bin centers [x0, x1]
      x = np.array([[0.01724138, 0.025], [0.05172414, 0.025], [0.0862069, 0.025], [0.12068966, 0.025], [0.15517241, 0.025], [0.18965517, 0.025], [0.22413793, 0.025], [0.25862069, 0.025], [0.29310345, 0.025], [0.32758621, 0.025], [0.36206897, 0.025], [0.39655172, 0.025], [0.43103448, 0.025], [0.46551724, 0.025], [0.5, 0.025], [0.53448276, 0.025], [0.56896552, 0.025], [0.60344828, 0.025], [0.63793103, 0.025], [0.67241379, 0.025], [0.70689655, 0.025], [0.74137931, 0.025], [0.77586207, 0.025], [0.81034483, 0.025], [0.84482759, 0.025], [0.87931034, 0.025], [0.9137931, 0.025], [0.94827586, 0.025], [0.98275862, 0.025], [0.01724138, 0.075], [0.05172414, 0.075], [0.0862069, 0.075], [0.12068966, 0.075], [0.15517241, 0.075], [0.18965517, 0.075], [0.22413793, 0.075], [0.25862069, 0.075], [0.29310345, 0.075], [0.32758621, 0.075], [0.36206897, 0.075], [0.39655172, 0.075], [0.43103448, 0.075], [0.46551724, 0.075], [0.5, 0.075], [0.53448276, 0.075], [0.56896552, 0.075], [0.60344828, 0.075], [0.63793103, 0.075], [0.67241379, 0.075], [0.70689655, 0.075], [0.74137931, 0.075], [0.77586207, 0.075], [0.81034483, 0.075], [0.84482759, 0.075], [0.87931034, 0.075], [0.9137931, 0.075], [0.94827586, 0.075], [0.98275862, 0.075], [0.01724138, 0.125], [0.05172414, 0.125], [0.0862069, 0.125], [0.12068966, 0.125], [0.15517241, 0.125], [0.18965517, 0.125], [0.22413793, 0.125], [0.25862069, 0.125], [0.29310345, 0.125], [0.32758621, 0.125], [0.36206897, 0.125], [0.39655172, 0.125], [0.43103448, 0.125], [0.46551724, 0.125], [0.5, 0.125], [0.53448276, 0.125], [0.56896552, 0.125], [0.60344828, 0.125], [0.63793103, 0.125], [0.67241379, 0.125], [0.70689655, 0.125], [0.74137931, 0.125], [0.77586207, 0.125], [0.81034483, 0.125], [0.84482759, 0.125], [0.87931034, 0.125], [0.9137931, 0.125], [0.94827586, 0.125], [0.98275862, 0.125], [0.01724138, 0.175], [0.05172414, 0.175], [0.0862069, 0.175], [0.12068966, 0.175], [0.15517241, 0.175], [0.18965517, 0.175], [0.22413793, 0.175], [0.25862069, 0.175], [0.29310345, 0.175], [0.32758621, 0.175], [0.36206897, 0.175], [0.39655172, 0.175], [0.43103448, 0.175], [0.46551724, 0.175], [0.5, 0.175], [0.53448276, 0.175], [0.56896552, 0.175], [0.60344828, 0.175], [0.63793103, 0.175], [0.67241379, 0.175], [0.70689655, 0.175], [0.74137931, 0.175], [0.77586207, 0.175], [0.81034483, 0.175], [0.84482759, 0.175], [0.87931034, 0.175], [0.9137931, 0.175], [0.94827586, 0.175], [0.98275862, 0.175], [0.01724138, 0.225], [0.05172414, 0.225], [0.0862069, 0.225], [0.12068966, 0.225], [0.15517241, 0.225], [0.18965517, 0.225], [0.22413793, 0.225], [0.25862069, 0.225], [0.29310345, 0.225], [0.32758621, 0.225], [0.36206897, 0.225], [0.39655172, 0.225], [0.43103448, 0.225], [0.46551724, 0.225], [0.5, 0.225], [0.53448276, 0.225], [0.56896552, 0.225], [0.60344828, 0.225], [0.63793103, 0.225], [0.67241379, 0.225], [0.70689655, 0.225], [0.74137931, 0.225], [0.77586207, 0.225], [0.81034483, 0.225], [0.84482759, 0.225], [0.87931034, 0.225], [0.9137931, 0.225], [0.94827586, 0.225], [0.98275862, 0.225], [0.01724138, 0.275], [0.05172414, 0.275], [0.0862069, 0.275], [0.12068966, 0.275], [0.15517241, 0.275], [0.18965517, 0.275], [0.22413793, 0.275], [0.25862069, 0.275], [0.29310345, 0.275], [0.32758621, 0.275], [0.36206897, 0.275], [0.39655172, 0.275], [0.43103448, 0.275], [0.46551724, 0.275], [0.5, 0.275], [0.53448276, 0.275], [0.56896552, 0.275], [0.60344828, 0.275], [0.63793103, 0.275], [0.67241379, 0.275], [0.70689655, 0.275], [0.74137931, 0.275], [0.77586207, 0.275], [0.81034483, 0.275], [0.84482759, 0.275], [0.87931034, 0.275], [0.9137931, 0.275], [0.94827586, 0.275], [0.98275862, 0.275], [0.01724138, 0.375], [0.05172414, 0.375], [0.0862069, 0.375], [0.12068966, 0.375], [0.15517241, 0.375], [0.18965517, 0.375], [0.22413793, 0.375], [0.25862069, 0.375], [0.29310345, 0.375], [0.32758621, 0.375], [0.36206897, 0.375], [0.39655172, 0.375], [0.43103448, 0.375], [0.46551724, 0.375], [0.5, 0.375], [0.53448276, 0.375], [0.56896552, 0.375], [0.60344828, 0.375], [0.63793103, 0.375], [0.67241379, 0.375], [0.70689655, 0.375], [0.74137931, 0.375], [0.77586207, 0.375], [0.81034483, 0.375], [0.84482759, 0.375], [0.87931034, 0.375], [0.9137931, 0.375], [0.94827586, 0.375], [0.98275862, 0.375], [0.01724138, 0.525], [0.05172414, 0.525], [0.0862069, 0.525], [0.12068966, 0.525], [0.15517241, 0.525], [0.18965517, 0.525], [0.22413793, 0.525], [0.25862069, 0.525], [0.29310345, 0.525], [0.32758621, 0.525], [0.36206897, 0.525], [0.39655172, 0.525], [0.43103448, 0.525], [0.46551724, 0.525], [0.5, 0.525], [0.53448276, 0.525], [0.56896552, 0.525], [0.60344828, 0.525], [0.63793103, 0.525], [0.67241379, 0.525], [0.70689655, 0.525], [0.74137931, 0.525], [0.77586207, 0.525], [0.81034483, 0.525], [0.84482759, 0.525], [0.87931034, 0.525], [0.9137931, 0.525], [0.94827586, 0.525], [0.98275862, 0.525], [0.01724138, 0.7], [0.05172414, 0.7], [0.0862069, 0.7], [0.12068966, 0.7], [0.15517241, 0.7], [0.18965517, 0.7], [0.22413793, 0.7], [0.25862069, 0.7], [0.29310345, 0.7], [0.32758621, 0.7], [0.36206897, 0.7], [0.39655172, 0.7], [0.43103448, 0.7], [0.46551724, 0.7], [0.5, 0.7], [0.53448276, 0.7], [0.56896552, 0.7], [0.60344828, 0.7], [0.63793103, 0.7], [0.67241379, 0.7], [0.70689655, 0.7], [0.74137931, 0.7], [0.77586207, 0.7], [0.81034483, 0.7], [0.84482759, 0.7], [0.87931034, 0.7], [0.9137931, 0.7], [0.94827586, 0.7], [0.98275862, 0.7], [0.01724138, 0.9], [0.05172414, 0.9], [0.0862069, 0.9], [0.12068966, 0.9], [0.15517241, 0.9], [0.18965517, 0.9], [0.22413793, 0.9], [0.25862069, 0.9], [0.29310345, 0.9], [0.32758621, 0.9], [0.36206897, 0.9], [0.39655172, 0.9], [0.43103448, 0.9], [0.46551724, 0.9], [0.5, 0.9], [0.53448276, 0.9], [0.56896552, 0.9], [0.60344828, 0.9], [0.63793103, 0.9], [0.67241379, 0.9], [0.70689655, 0.9], [0.74137931, 0.9], [0.77586207, 0.9], [0.81034483, 0.9], [0.84482759, 0.9], [0.87931034, 0.9], [0.9137931, 0.9], [0.94827586, 0.9], [0.98275862, 0.9]])
        
      bin_edges_2d = [
      # bin edges for x0, including both the leftmost and rightmost bin edge locations
      [0.0, 0.03448276, 0.06896552, 0.10344828, 0.13793103, 0.17241379, 0.20689655, 0.24137931, 0.27586207, 0.31034483, 0.34482759, 0.37931034, 0.4137931, 0.44827586, 0.48275862, 0.51724138, 0.55172414, 0.5862069, 0.62068966, 0.65517241, 0.68965517, 0.72413793, 0.75862069, 0.79310345, 0.82758621, 0.86206897, 0.89655172, 0.93103448, 0.96551724, 1.0],
      # bin edges for x1, including both the leftmost and rightmost bin edge locations
      [0.0, 0.05, 0.1, 0.15, 0.2, 0.25, 0.3, 0.45, 0.6, 0.8, 1.0]
      ]

      # bin content in the same order as x
      y=np.array([9.69087033, 8.93382434, 8.62087085, 8.22193329, 7.8692739, 7.50183981, 7.18556803, 6.73645261, 6.57797409, 6.35008574, 6.26552493, 5.83064083, 5.93032735, 5.95988121, 5.94548078, 5.96148523, 6.01091857, 6.07447448, 6.21953594, 6.41004495, 6.58756909, 6.89018833, 7.16391786, 7.4830389, 7.82216532, 8.15586626, 8.71204648, 9.14302323, 9.63535032, 9.73385291, 9.18139508, 8.76857145, 8.35375319, 7.7572498, 7.34035647, 7.16759684, 7.01125476, 6.78990783, 6.541082, 6.39009392, 6.29184684, 6.1638982, 6.15155554, 5.97884639, 6.13228741, 6.12173215, 6.26666274, 6.38237076, 6.52343719, 6.78169684, 6.79180799, 7.18630754, 7.39497505, 7.80744658, 8.28646619, 8.58849151, 9.23449294, 9.71925399, 9.74620032, 9.25154812, 8.79081266, 8.41905432, 7.93223088, 7.70033909, 7.41343633, 7.12053929, 6.93893497, 6.63663019, 6.59504595, 6.09473855, 6.26715675, 6.32211186, 6.32030797, 6.19791516, 6.28265517, 6.36561939, 6.4949997, 6.75255648, 6.91194209, 7.16765613, 7.28208054, 7.6589835, 8.03343777, 8.43333465, 8.80884345, 9.2474896, 9.64885385, 9.67131807, 9.12326677, 8.84490487, 8.50791631, 8.07128678, 7.732174, 7.5110565, 7.20294387, 7.05644589, 6.86769582, 6.73037558, 6.66037488, 6.5677757, 6.52730882, 6.44430297, 6.49497984, 6.51683868, 6.45686084, 6.75357977, 6.88538973, 7.00996516, 7.30465156, 7.56854535, 7.82565253, 8.15767312, 8.32928945, 8.77446378, 9.23143631, 9.61110393, 9.66036809, 9.33808801, 8.78033912, 8.5466157, 8.15235895, 7.79295374, 7.68849863, 7.4713833, 7.25699546, 7.06048585, 6.82155464, 6.66693066, 6.77493629, 6.67260648, 6.66990041, 6.71107785, 6.76536344, 6.82195894, 6.72486884, 7.07586011, 7.21351688, 7.36333393, 7.67790843, 7.67959121, 7.99117579, 8.58265326, 8.9077152, 9.32643134, 9.75007268, 9.78859927, 9.3204434, 8.97043993, 8.68798097, 8.35617764, 7.86464953, 7.8384306, 7.62468217, 7.39317691, 6.85464244, 7.13536928, 6.97294082, 6.87344999, 6.91968899, 6.82361763, 6.90243178, 6.89802139, 6.96905132, 7.07951243, 7.27863174, 7.31430495, 7.61110042, 7.84070794, 8.10441417, 8.29756949, 8.58907835, 9.02854044, 9.35079681, 9.76729249, 9.73941067, 9.46447159, 9.09312123, 8.84342173, 8.39501377, 8.36556607, 8.13256985, 7.96537613, 7.63328293, 7.5096008, 7.5372741, 7.38177467, 7.26280568, 7.31749845, 7.31187369, 7.34751019, 7.40271534, 7.3086444, 7.34117564, 7.59310647, 7.77456091, 7.94110641, 8.03383018, 8.15562519, 8.44692565, 8.74381742, 9.0795214, 9.47393739, 9.80871141, 9.67107341, 9.53872367, 9.39424834, 9.17743282, 8.92797503, 8.81894556, 8.64876443, 8.45141686, 8.31321804, 8.2061693, 8.20877003, 8.08321907, 8.09444918, 8.05555789, 7.97008587, 8.02634138, 7.96629427, 8.08987465, 8.15275216, 8.29956456, 8.37591085, 8.50395763, 8.64463427, 8.53261726, 8.94817661, 9.02858491, 9.31001123, 9.50488526, 9.81949316, 9.86486967, 9.7581208, 9.67122546, 9.49168777, 9.44694501, 9.38815718, 9.23421929, 9.2231317, 8.95528535, 8.88649523, 8.87122249, 9.00991905, 9.02564791, 8.81698994, 8.96475981, 8.81887333, 8.81192205, 8.87080468, 9.049794, 9.08820743, 9.01444317, 9.20746549, 9.28934531, 9.31592583, 9.2632024, 9.49498755, 9.63343127, 9.79697604, 9.86361866, 9.70944921, 10.02572551, 10.00860156, 9.87637715, 9.97851359, 10.01994908, 10.01563133, 10.10796177, 10.13073929, 10.00753649, 10.03154518, 10.03914842, 9.99320052, 10.1357776, 10.14161959, 10.04389118, 10.08009571, 10.09973963, 10.03737151, 10.00314623, 10.12456147, 10.10906068, 10.12351256, 10.04588777, 10.09579461, 10.02784908, 9.99694998, 10.01061966, 9.94934048])

      y_up=np.array([0.48454352, 0.44669122, 0.43104354, 0.41109666, 0.3934637, 0.37509199, 0.3592784, 0.33682263, 0.3288987, 0.31750429, 0.31327625, 0.29153204, 0.29651637, 0.29799406, 0.29727404, 0.29807426, 0.30054593, 0.30372372, 0.3109768, 0.32050225, 0.32937845, 0.34450942, 0.35819589, 0.37415195, 0.39110827, 0.40779331, 0.43560232, 0.45715116, 0.48176752, 0.48669265, 0.45906975, 0.43842857, 0.41768766, 0.38786249, 0.36701782, 0.35837984, 0.35056274, 0.33949539, 0.3270541, 0.3195047, 0.31459234, 0.30819491, 0.30757778, 0.29894232, 0.30661437, 0.30608661, 0.31333314, 0.31911854, 0.32617186, 0.33908484, 0.3395904, 0.35931538, 0.36974875, 0.39037233, 0.41432331, 0.42942458, 0.46172465, 0.4859627, 0.48731002, 0.46257741, 0.43954063, 0.42095272, 0.39661154, 0.38501695, 0.37067182, 0.35602696, 0.34694675, 0.33183151, 0.3297523, 0.30473693, 0.31335784, 0.31610559, 0.3160154, 0.30989576, 0.31413276, 0.31828097, 0.32474998, 0.33762782, 0.3455971, 0.35838281, 0.36410403, 0.38294917, 0.40167189, 0.42166673, 0.44044217, 0.46237448, 0.48244269, 0.4835659, 0.45616334, 0.44224524, 0.42539582, 0.40356434, 0.3866087, 0.37555283, 0.36014719, 0.35282229, 0.34338479, 0.33651878, 0.33301874, 0.32838879, 0.32636544, 0.32221515, 0.32474899, 0.32584193, 0.32284304, 0.33767899, 0.34426949, 0.35049826, 0.36523258, 0.37842727, 0.39128263, 0.40788366, 0.41646447, 0.43872319, 0.46157182, 0.4805552, 0.4830184, 0.4669044, 0.43901696, 0.42733079, 0.40761795, 0.38964769, 0.38442493, 0.37356916, 0.36284977, 0.35302429, 0.34107773, 0.33334653, 0.33874681, 0.33363032, 0.33349502, 0.33555389, 0.33826817, 0.34109795, 0.33624344, 0.35379301, 0.36067584, 0.3681667, 0.38389542, 0.38397956, 0.39955879, 0.42913266, 0.44538576, 0.46632157, 0.48750363, 0.48942996, 0.46602217, 0.448522, 0.43439905, 0.41780888, 0.39323248, 0.39192153, 0.38123411, 0.36965885, 0.34273212, 0.35676846, 0.34864704, 0.3436725, 0.34598445, 0.34118088, 0.34512159, 0.34490107, 0.34845257, 0.35397562, 0.36393159, 0.36571525, 0.38055502, 0.3920354, 0.40522071, 0.41487847, 0.42945392, 0.45142702, 0.46753984, 0.48836462, 0.48697053, 0.47322358, 0.45465606, 0.44217109, 0.41975069, 0.4182783, 0.40662849, 0.39826881, 0.38166415, 0.37548004, 0.37686371, 0.36908873, 0.36314028, 0.36587492, 0.36559368, 0.36737551, 0.37013577, 0.36543222, 0.36705878, 0.37965532, 0.38872805, 0.39705532, 0.40169151, 0.40778126, 0.42234628, 0.43719087, 0.45397607, 0.47369687, 0.49043557, 0.48355367, 0.47693618, 0.46971242, 0.45887164, 0.44639875, 0.44094728, 0.43243822, 0.42257084, 0.4156609, 0.41030847, 0.4104385, 0.40416095, 0.40472246, 0.40277789, 0.39850429, 0.40131707, 0.39831471, 0.40449373, 0.40763761, 0.41497823, 0.41879554, 0.42519788, 0.43223171, 0.42663086, 0.44740883, 0.45142925, 0.46550056, 0.47524426, 0.49097466, 0.49324348, 0.48790604, 0.48356127, 0.47458439, 0.47234725, 0.46940786, 0.46171096, 0.46115659, 0.44776427, 0.44432476, 0.44356112, 0.45049595, 0.4512824, 0.4408495, 0.44823799, 0.44094367, 0.4405961, 0.44354023, 0.4524897, 0.45441037, 0.45072216, 0.46037327, 0.46446727, 0.46579629, 0.46316012, 0.47474938, 0.48167156, 0.4898488, 0.49318093, 0.48547246, 0.50128628, 0.50043008, 0.49381886, 0.49892568, 0.50099745, 0.50078157, 0.50539809, 0.50653696, 0.50037682, 0.50157726, 0.50195742, 0.49966003, 0.50678888, 0.50708098, 0.50219456, 0.50400479, 0.50498698, 0.50186858, 0.50015731, 0.50622807, 0.50545303, 0.50617563, 0.50229439, 0.50478973, 0.50139245, 0.4998475, 0.50053098, 0.49746702])

      y_down=np.array([0.48454352, 0.44669122, 0.43104354, 0.41109666, 0.3934637, 0.37509199, 0.3592784, 0.33682263, 0.3288987, 0.31750429, 0.31327625, 0.29153204, 0.29651637, 0.29799406, 0.29727404, 0.29807426, 0.30054593, 0.30372372, 0.3109768, 0.32050225, 0.32937845, 0.34450942, 0.35819589, 0.37415195, 0.39110827, 0.40779331, 0.43560232, 0.45715116, 0.48176752, 0.48669265, 0.45906975, 0.43842857, 0.41768766, 0.38786249, 0.36701782, 0.35837984, 0.35056274, 0.33949539, 0.3270541, 0.3195047, 0.31459234, 0.30819491, 0.30757778, 0.29894232, 0.30661437, 0.30608661, 0.31333314, 0.31911854, 0.32617186, 0.33908484, 0.3395904, 0.35931538, 0.36974875, 0.39037233, 0.41432331, 0.42942458, 0.46172465, 0.4859627, 0.48731002, 0.46257741, 0.43954063, 0.42095272, 0.39661154, 0.38501695, 0.37067182, 0.35602696, 0.34694675, 0.33183151, 0.3297523, 0.30473693, 0.31335784, 0.31610559, 0.3160154, 0.30989576, 0.31413276, 0.31828097, 0.32474998, 0.33762782, 0.3455971, 0.35838281, 0.36410403, 0.38294917, 0.40167189, 0.42166673, 0.44044217, 0.46237448, 0.48244269, 0.4835659, 0.45616334, 0.44224524, 0.42539582, 0.40356434, 0.3866087, 0.37555283, 0.36014719, 0.35282229, 0.34338479, 0.33651878, 0.33301874, 0.32838879, 0.32636544, 0.32221515, 0.32474899, 0.32584193, 0.32284304, 0.33767899, 0.34426949, 0.35049826, 0.36523258, 0.37842727, 0.39128263, 0.40788366, 0.41646447, 0.43872319, 0.46157182, 0.4805552, 0.4830184, 0.4669044, 0.43901696, 0.42733079, 0.40761795, 0.38964769, 0.38442493, 0.37356916, 0.36284977, 0.35302429, 0.34107773, 0.33334653, 0.33874681, 0.33363032, 0.33349502, 0.33555389, 0.33826817, 0.34109795, 0.33624344, 0.35379301, 0.36067584, 0.3681667, 0.38389542, 0.38397956, 0.39955879, 0.42913266, 0.44538576, 0.46632157, 0.48750363, 0.48942996, 0.46602217, 0.448522, 0.43439905, 0.41780888, 0.39323248, 0.39192153, 0.38123411, 0.36965885, 0.34273212, 0.35676846, 0.34864704, 0.3436725, 0.34598445, 0.34118088, 0.34512159, 0.34490107, 0.34845257, 0.35397562, 0.36393159, 0.36571525, 0.38055502, 0.3920354, 0.40522071, 0.41487847, 0.42945392, 0.45142702, 0.46753984, 0.48836462, 0.48697053, 0.47322358, 0.45465606, 0.44217109, 0.41975069, 0.4182783, 0.40662849, 0.39826881, 0.38166415, 0.37548004, 0.37686371, 0.36908873, 0.36314028, 0.36587492, 0.36559368, 0.36737551, 0.37013577, 0.36543222, 0.36705878, 0.37965532, 0.38872805, 0.39705532, 0.40169151, 0.40778126, 0.42234628, 0.43719087, 0.45397607, 0.47369687, 0.49043557, 0.48355367, 0.47693618, 0.46971242, 0.45887164, 0.44639875, 0.44094728, 0.43243822, 0.42257084, 0.4156609, 0.41030847, 0.4104385, 0.40416095, 0.40472246, 0.40277789, 0.39850429, 0.40131707, 0.39831471, 0.40449373, 0.40763761, 0.41497823, 0.41879554, 0.42519788, 0.43223171, 0.42663086, 0.44740883, 0.45142925, 0.46550056, 0.47524426, 0.49097466, 0.49324348, 0.48790604, 0.48356127, 0.47458439, 0.47234725, 0.46940786, 0.46171096, 0.46115659, 0.44776427, 0.44432476, 0.44356112, 0.45049595, 0.4512824, 0.4408495, 0.44823799, 0.44094367, 0.4405961, 0.44354023, 0.4524897, 0.45441037, 0.45072216, 0.46037327, 0.46446727, 0.46579629, 0.46316012, 0.47474938, 0.48167156, 0.4898488, 0.49318093, 0.48547246, 0.50128628, 0.50043008, 0.49381886, 0.49892568, 0.50099745, 0.50078157, 0.50539809, 0.50653696, 0.50037682, 0.50157726, 0.50195742, 0.49966003, 0.50678888, 0.50708098, 0.50219456, 0.50400479, 0.50498698, 0.50186858, 0.50015731, 0.50622807, 0.50545303, 0.50617563, 0.50229439, 0.50478973, 0.50139245, 0.4998475, 0.50053098, 0.49746702])

.. container:: cell code
   :name: f3415459-b989-4cbe-8472-3fe2ae77f9be

   .. code:: python

      from pysr import PySRRegressor
      import sympy

      pysr_config = PySRRegressor(
          model_selection = 'accuracy',
          niterations = 200,
          maxsize = 60,
          binary_operators = [
              '+', '*'
                           ],
          unary_operators = [
              'exp',
              'gauss(x) = exp(-x*x)',
              'tanh',
          ],
          nested_constraints = {
              'tanh':   {'tanh': 0, 'exp': 0, 'gauss': 0, '*': 2},
              'exp':    {'tanh': 0, 'exp': 0, 'gauss': 0, '*': 2},
              'gauss':  {'tanh': 0, 'exp': 0, 'gauss': 0, '*': 2},
              '*':      {'tanh': 1, 'exp': 1, 'gauss': 1, '*': 2},
          },
          extra_sympy_mappings={
              'gauss': lambda x: sympy.exp(-x*x),
                               },
          loss='loss(y, y_pred, weights) = (y - y_pred)^2 * weights',
      )

.. container:: cell code
   :name: a61d9307-8b17-42dc-9915-3a4d0f7d1c51

   .. code:: python

      from symbolfit.symbolfit import *

      model = SymbolFit(
              x = x,
              y = y,
              y_up = y_up,
              y_down = y_down,
              pysr_config = pysr_config,
              max_complexity = 50,
              input_rescale = False,
              scale_y_by = None,
              max_stderr = 20,
              fit_y_unc = True,
              random_seed = seed,
              loss_weights = None
      )

      model.fit()

.. container:: cell code
   :name: 014cd1d2-0b50-431d-9a47-3b356de10d14

   .. code:: python

      model.save_to_csv(output_dir = 'toy_dataset_3a/')

.. container:: cell code
   :name: cd1b926b-6942-4e5c-8b32-1570be622800

   .. code:: python

      model.plot_to_pdf(
          	output_dir = 'toy_dataset_3a/',
          	#bin_widths_1d = bin_widths_1d,
          	bin_edges_2d = bin_edges_2d,
          	plot_logy = False,
          	plot_logx = False,
              sampling_95quantile = False
      )

.. container:: cell code
   :name: c243c219-799e-49f2-a6ce-812203375189

   .. code:: python

.. container:: cell markdown
   :name: 7e41691a-8945-4719-952a-6f35dabc68a8

   .. rubric:: Toy Dataset 2b
      :name: toy-dataset-2b

.. container:: cell code
   :name: f7bbb46c-6d88-4293-8d2a-bc11e2df5201

   .. code:: python

      import numpy as np

      # each element contains bin centers [x0, x1]
      x = np.array([[0.03684211, 0.1], [0.11052632, 0.1], [0.18421053, 0.1], [0.25789474, 0.1], [0.33157895, 0.1], [0.40526316, 0.1], [0.47894737, 0.1], [0.55263158, 0.1], [0.62631579, 0.1], [0.7, 0.1], [0.77368421, 0.1], [0.84736842, 0.1], [0.92105263, 0.1], [0.99473684, 0.1], [1.06842105, 0.1], [1.14210526, 0.1], [1.21578947, 0.1], [1.28947368, 0.1], [1.36315789, 0.1], [0.03684211, 0.225], [0.11052632, 0.225], [0.18421053, 0.225], [0.25789474, 0.225], [0.33157895, 0.225], [0.40526316, 0.225], [0.47894737, 0.225], [0.55263158, 0.225], [0.62631579, 0.225], [0.7, 0.225], [0.77368421, 0.225], [0.84736842, 0.225], [0.92105263, 0.225], [0.99473684, 0.225], [1.06842105, 0.225], [1.14210526, 0.225], [1.21578947, 0.225], [1.28947368, 0.225], [1.36315789, 0.225], [0.03684211, 0.35], [0.11052632, 0.35], [0.18421053, 0.35], [0.25789474, 0.35], [0.33157895, 0.35], [0.40526316, 0.35], [0.47894737, 0.35], [0.55263158, 0.35], [0.62631579, 0.35], [0.7, 0.35], [0.77368421, 0.35], [0.84736842, 0.35], [0.92105263, 0.35], [0.99473684, 0.35], [1.06842105, 0.35], [1.14210526, 0.35], [1.21578947, 0.35], [1.28947368, 0.35], [1.36315789, 0.35], [0.03684211, 0.45], [0.11052632, 0.45], [0.18421053, 0.45], [0.25789474, 0.45], [0.33157895, 0.45], [0.40526316, 0.45], [0.47894737, 0.45], [0.55263158, 0.45], [0.62631579, 0.45], [0.7, 0.45], [0.77368421, 0.45], [0.84736842, 0.45], [0.92105263, 0.45], [0.99473684, 0.45], [1.06842105, 0.45], [1.14210526, 0.45], [1.21578947, 0.45], [1.28947368, 0.45], [1.36315789, 0.45], [0.03684211, 0.55], [0.11052632, 0.55], [0.18421053, 0.55], [0.25789474, 0.55], [0.33157895, 0.55], [0.40526316, 0.55], [0.47894737, 0.55], [0.55263158, 0.55], [0.62631579, 0.55], [0.7, 0.55], [0.77368421, 0.55], [0.84736842, 0.55], [0.92105263, 0.55], [0.99473684, 0.55], [1.06842105, 0.55], [1.14210526, 0.55], [1.21578947, 0.55], [1.28947368, 0.55], [1.36315789, 0.55], [0.03684211, 0.725], [0.11052632, 0.725], [0.18421053, 0.725], [0.25789474, 0.725], [0.33157895, 0.725], [0.40526316, 0.725], [0.47894737, 0.725], [0.55263158, 0.725], [0.62631579, 0.725], [0.7, 0.725], [0.77368421, 0.725], [0.84736842, 0.725], [0.92105263, 0.725], [0.99473684, 0.725], [1.06842105, 0.725], [1.14210526, 0.725], [1.21578947, 0.725], [1.28947368, 0.725], [1.36315789, 0.725], [0.03684211, 0.9], [0.11052632, 0.9], [0.18421053, 0.9], [0.25789474, 0.9], [0.33157895, 0.9], [0.40526316, 0.9], [0.47894737, 0.9], [0.55263158, 0.9], [0.62631579, 0.9], [0.7, 0.9], [0.77368421, 0.9], [0.84736842, 0.9], [0.92105263, 0.9], [0.99473684, 0.9], [1.06842105, 0.9], [1.14210526, 0.9], [1.21578947, 0.9], [1.28947368, 0.9], [1.36315789, 0.9], [0.03684211, 0.975], [0.11052632, 0.975], [0.18421053, 0.975], [0.25789474, 0.975], [0.33157895, 0.975], [0.40526316, 0.975], [0.47894737, 0.975], [0.55263158, 0.975], [0.62631579, 0.975], [0.7, 0.975], [0.77368421, 0.975], [0.84736842, 0.975], [0.92105263, 0.975], [0.99473684, 0.975], [1.06842105, 0.975], [1.14210526, 0.975], [1.21578947, 0.975], [1.28947368, 0.975], [1.36315789, 0.975]])
        
      bin_edges_2d = [
      # bin edges for x0, including both the leftmost and rightmost bin edge locations
      [0.0, 0.07368421, 0.14736842, 0.22105263, 0.29473684, 0.36842105, 0.44210526, 0.51578947, 0.58947368, 0.66315789, 0.73684211, 0.81052632, 0.88421053, 0.95789474, 1.03157895, 1.10526316, 1.17894737, 1.25263158, 1.32631579, 1.4],
      # bin edges for x1, including both the leftmost and rightmost bin edge locations
      [0.05, 0.15, 0.3, 0.4, 0.5, 0.6, 0.85, 0.95, 1]
      ]

      # bin content in the same order as x
      y=np.array([8.83193586, 7.91341723, 8.03091001, 7.42447545, 6.91258977, 5.98547941, 5.91028251, 4.67070766, 4.77901306, 4.76733036, 4.05550476, 3.70405401, 4.03351894, 4.21029162, 4.2722937, 4.99467451, 5.28290457, 6.20312847, 6.68585699, 9.82699573, 9.47707466, 9.72053873, 9.83023841, 9.09306144, 8.81794668, 8.18928382, 6.86737915, 6.29500435, 5.50669678, 5.08323273, 4.19375359, 4.0886373, 4.5492384, 4.54968485, 5.1029162, 6.1472327, 7.10354665, 8.37699487, 8.55059437, 8.72867784, 9.65035122, 9.64036249, 9.55057575, 9.59792925, 9.04879677, 8.54540577, 7.68083907, 6.19110526, 5.6242934, 4.92380659, 4.35594898, 4.79968404, 4.63544226, 5.36030833, 6.56378032, 7.66171635, 9.14498357, 8.11431037, 8.39535471, 8.85379364, 9.12401524, 9.83417576, 9.56390777, 10.16594685, 9.19206158, 7.89302548, 6.76165292, 5.83983372, 5.04335869, 4.37920708, 4.61145656, 5.06503842, 5.81543965, 6.75411561, 8.3400158, 9.57473415, 7.61689025, 7.66988009, 8.25985073, 8.79761876, 8.86967015, 9.59744512, 9.76409991, 9.21985288, 8.64956125, 7.515425, 6.33006142, 5.41649484, 4.29974677, 4.50916865, 5.32452366, 6.1896524, 7.51910787, 9.59361374, 9.68855745, 7.544645, 7.59807432, 7.80342797, 8.07997455, 8.84542734, 9.14409582, 9.58219482, 9.59767454, 9.08221356, 8.24712458, 6.31943404, 5.71276441, 4.53502094, 4.80952194, 5.66668324, 6.53878354, 7.78954399, 8.90752485, 9.76845122, 6.97490313, 7.08008521, 7.25842299, 7.61550619, 8.51408093, 9.01769602, 8.99188815, 9.6095188, 9.24840162, 8.566102, 6.89514999, 5.81744178, 5.12120875, 5.07673853, 5.42844532, 6.71837687, 8.21921539, 9.39540658, 10.05448839, 7.2180587, 6.63685231, 7.46436077, 8.00223611, 8.26566338, 8.50239314, 9.03505473, 9.72397462, 9.32492206, 8.54917292, 7.32267931, 5.77802238, 5.25387892, 4.43204111, 5.48265587, 6.91471303, 8.20611211, 9.70432951, 9.3441517])

      y_up=np.array([0.88319359, 0.79134172, 0.803091, 0.74244755, 0.69125898, 0.59854794, 0.59102825, 0.46707077, 0.47790131, 0.47673304, 0.40555048, 0.3704054, 0.40335189, 0.42102916, 0.42722937, 0.49946745, 0.52829046, 0.62031285, 0.6685857, 0.98269957, 0.94770747, 0.97205387, 0.98302384, 0.90930614, 0.88179467, 0.81892838, 0.68673792, 0.62950043, 0.55066968, 0.50832327, 0.41937536, 0.40886373, 0.45492384, 0.45496849, 0.51029162, 0.61472327, 0.71035466, 0.83769949, 0.85505944, 0.87286778, 0.96503512, 0.96403625, 0.95505757, 0.95979292, 0.90487968, 0.85454058, 0.76808391, 0.61911053, 0.56242934, 0.49238066, 0.4355949, 0.4799684, 0.46354423, 0.53603083, 0.65637803, 0.76617163, 0.91449836, 0.81143104, 0.83953547, 0.88537936, 0.91240152, 0.98341758, 0.95639078, 1.01659469, 0.91920616, 0.78930255, 0.67616529, 0.58398337, 0.50433587, 0.43792071, 0.46114566, 0.50650384, 0.58154397, 0.67541156, 0.83400158, 0.95747341, 0.76168902, 0.76698801, 0.82598507, 0.87976188, 0.88696702, 0.95974451, 0.97640999, 0.92198529, 0.86495612, 0.7515425, 0.63300614, 0.54164948, 0.42997468, 0.45091687, 0.53245237, 0.61896524, 0.75191079, 0.95936137, 0.96885575, 0.7544645, 0.75980743, 0.7803428, 0.80799746, 0.88454273, 0.91440958, 0.95821948, 0.95976745, 0.90822136, 0.82471246, 0.6319434, 0.57127644, 0.45350209, 0.48095219, 0.56666832, 0.65387835, 0.7789544, 0.89075248, 0.97684512, 0.69749031, 0.70800852, 0.7258423, 0.76155062, 0.85140809, 0.9017696, 0.89918881, 0.96095188, 0.92484016, 0.8566102, 0.689515, 0.58174418, 0.51212087, 0.50767385, 0.54284453, 0.67183769, 0.82192154, 0.93954066, 1.00544884, 0.72180587, 0.66368523, 0.74643608, 0.80022361, 0.82656634, 0.85023931, 0.90350547, 0.97239746, 0.93249221, 0.85491729, 0.73226793, 0.57780224, 0.52538789, 0.44320411, 0.54826559, 0.6914713, 0.82061121, 0.97043295, 0.93441517])

      y_down=np.array([0.88319359, 0.79134172, 0.803091, 0.74244755, 0.69125898, 0.59854794, 0.59102825, 0.46707077, 0.47790131, 0.47673304, 0.40555048, 0.3704054, 0.40335189, 0.42102916, 0.42722937, 0.49946745, 0.52829046, 0.62031285, 0.6685857, 0.98269957, 0.94770747, 0.97205387, 0.98302384, 0.90930614, 0.88179467, 0.81892838, 0.68673792, 0.62950043, 0.55066968, 0.50832327, 0.41937536, 0.40886373, 0.45492384, 0.45496849, 0.51029162, 0.61472327, 0.71035466, 0.83769949, 0.85505944, 0.87286778, 0.96503512, 0.96403625, 0.95505757, 0.95979292, 0.90487968, 0.85454058, 0.76808391, 0.61911053, 0.56242934, 0.49238066, 0.4355949, 0.4799684, 0.46354423, 0.53603083, 0.65637803, 0.76617163, 0.91449836, 0.81143104, 0.83953547, 0.88537936, 0.91240152, 0.98341758, 0.95639078, 1.01659469, 0.91920616, 0.78930255, 0.67616529, 0.58398337, 0.50433587, 0.43792071, 0.46114566, 0.50650384, 0.58154397, 0.67541156, 0.83400158, 0.95747341, 0.76168902, 0.76698801, 0.82598507, 0.87976188, 0.88696702, 0.95974451, 0.97640999, 0.92198529, 0.86495612, 0.7515425, 0.63300614, 0.54164948, 0.42997468, 0.45091687, 0.53245237, 0.61896524, 0.75191079, 0.95936137, 0.96885575, 0.7544645, 0.75980743, 0.7803428, 0.80799746, 0.88454273, 0.91440958, 0.95821948, 0.95976745, 0.90822136, 0.82471246, 0.6319434, 0.57127644, 0.45350209, 0.48095219, 0.56666832, 0.65387835, 0.7789544, 0.89075248, 0.97684512, 0.69749031, 0.70800852, 0.7258423, 0.76155062, 0.85140809, 0.9017696, 0.89918881, 0.96095188, 0.92484016, 0.8566102, 0.689515, 0.58174418, 0.51212087, 0.50767385, 0.54284453, 0.67183769, 0.82192154, 0.93954066, 1.00544884, 0.72180587, 0.66368523, 0.74643608, 0.80022361, 0.82656634, 0.85023931, 0.90350547, 0.97239746, 0.93249221, 0.85491729, 0.73226793, 0.57780224, 0.52538789, 0.44320411, 0.54826559, 0.6914713, 0.82061121, 0.97043295, 0.93441517])

.. container:: cell code
   :name: bd3537de-0f48-4c8c-b3e2-647cc41b0487

   .. code:: python

      from pysr import PySRRegressor
      import sympy

      pysr_config = PySRRegressor(
          model_selection = 'accuracy',
          niterations = 200,
          maxsize = 60,
          binary_operators = [
              '+', '*'
                           ],
          unary_operators = [
              'exp',
              'gauss(x) = exp(-x*x)',
              'tanh',
          ],
          nested_constraints = {
              'tanh':   {'tanh': 0, 'exp': 0, 'gauss': 0, '*': 2},
              'exp':    {'tanh': 0, 'exp': 0, 'gauss': 0, '*': 2},
              'gauss':  {'tanh': 0, 'exp': 0, 'gauss': 0, '*': 2},
              '*':      {'tanh': 1, 'exp': 1, 'gauss': 1, '*': 2},
          },
          extra_sympy_mappings={
              'gauss': lambda x: sympy.exp(-x*x),
                               },
          loss='loss(y, y_pred, weights) = (y - y_pred)^2 * weights',
      )

.. container:: cell code
   :name: 2cf77210-5932-4c6c-8866-1906ac721b43

   .. code:: python

      from symbolfit.symbolfit import *

      model = SymbolFit(
              x = x,
              y = y,
              y_up = y_up,
              y_down = y_down,
              pysr_config = pysr_config,
              max_complexity = 60,
              input_rescale = False,
              scale_y_by = None,
              max_stderr = 20,
              fit_y_unc = True,
              random_seed = seed,
              loss_weights = None
      )

      model.fit()

.. container:: cell code
   :name: 1c6291c9-9faa-439c-af79-eaf81c76b3fd

   .. code:: python

      model.save_to_csv(output_dir = 'toy_dataset_3b/')

.. container:: cell code
   :name: e3813c8b-77c1-4a5c-867d-d91a541568f3

   .. code:: python

      model.plot_to_pdf(
          	output_dir = 'toy_dataset_3b/',
          	#bin_widths_1d = bin_widths_1d,
          	bin_edges_2d = bin_edges_2d,
          	plot_logy = False,
          	plot_logx = False,
              sampling_95quantile = False
      )

.. container:: cell code
   :name: 28e85137-682d-4259-a58d-bcb512d79f94

   .. code:: python

.. container:: cell markdown
   :name: ee5ae7ad-c82d-483e-bf64-bd5b341178ea

   .. rubric:: Toy Dataset 2c
      :name: toy-dataset-2c

.. container:: cell code
   :name: 180f8ec1-4cb9-4014-9979-fa7a57173ca8

   .. code:: python

      import numpy as np

      # each element contains bin centers [x0, x1]
      x = np.array([[-0.89473684, 0.075], [-0.68421053, 0.075], [-0.47368421, 0.075], [-0.26315789, 0.075], [-0.05263158, 0.075], [0.15789474, 0.075], [0.36842105, 0.075], [0.57894737, 0.075], [0.78947368, 0.075], [1.0, 0.075], [1.21052632, 0.075], [1.42105263, 0.075], [1.63157895, 0.075], [1.84210526, 0.075], [2.05263158, 0.075], [2.26315789, 0.075], [2.47368421, 0.075], [2.68421053, 0.075], [2.89473684, 0.075], [-0.89473684, 0.225], [-0.68421053, 0.225], [-0.47368421, 0.225], [-0.26315789, 0.225], [-0.05263158, 0.225], [0.15789474, 0.225], [0.36842105, 0.225], [0.57894737, 0.225], [0.78947368, 0.225], [1.0, 0.225], [1.21052632, 0.225], [1.42105263, 0.225], [1.63157895, 0.225], [1.84210526, 0.225], [2.05263158, 0.225], [2.26315789, 0.225], [2.47368421, 0.225], [2.68421053, 0.225], [2.89473684, 0.225], [-0.89473684, 0.35], [-0.68421053, 0.35], [-0.47368421, 0.35], [-0.26315789, 0.35], [-0.05263158, 0.35], [0.15789474, 0.35], [0.36842105, 0.35], [0.57894737, 0.35], [0.78947368, 0.35], [1.0, 0.35], [1.21052632, 0.35], [1.42105263, 0.35], [1.63157895, 0.35], [1.84210526, 0.35], [2.05263158, 0.35], [2.26315789, 0.35], [2.47368421, 0.35], [2.68421053, 0.35], [2.89473684, 0.35], [-0.89473684, 0.45], [-0.68421053, 0.45], [-0.47368421, 0.45], [-0.26315789, 0.45], [-0.05263158, 0.45], [0.15789474, 0.45], [0.36842105, 0.45], [0.57894737, 0.45], [0.78947368, 0.45], [1.0, 0.45], [1.21052632, 0.45], [1.42105263, 0.45], [1.63157895, 0.45], [1.84210526, 0.45], [2.05263158, 0.45], [2.26315789, 0.45], [2.47368421, 0.45], [2.68421053, 0.45], [2.89473684, 0.45], [-0.89473684, 0.55], [-0.68421053, 0.55], [-0.47368421, 0.55], [-0.26315789, 0.55], [-0.05263158, 0.55], [0.15789474, 0.55], [0.36842105, 0.55], [0.57894737, 0.55], [0.78947368, 0.55], [1.0, 0.55], [1.21052632, 0.55], [1.42105263, 0.55], [1.63157895, 0.55], [1.84210526, 0.55], [2.05263158, 0.55], [2.26315789, 0.55], [2.47368421, 0.55], [2.68421053, 0.55], [2.89473684, 0.55], [-0.89473684, 0.65], [-0.68421053, 0.65], [-0.47368421, 0.65], [-0.26315789, 0.65], [-0.05263158, 0.65], [0.15789474, 0.65], [0.36842105, 0.65], [0.57894737, 0.65], [0.78947368, 0.65], [1.0, 0.65], [1.21052632, 0.65], [1.42105263, 0.65], [1.63157895, 0.65], [1.84210526, 0.65], [2.05263158, 0.65], [2.26315789, 0.65], [2.47368421, 0.65], [2.68421053, 0.65], [2.89473684, 0.65], [-0.89473684, 0.75], [-0.68421053, 0.75], [-0.47368421, 0.75], [-0.26315789, 0.75], [-0.05263158, 0.75], [0.15789474, 0.75], [0.36842105, 0.75], [0.57894737, 0.75], [0.78947368, 0.75], [1.0, 0.75], [1.21052632, 0.75], [1.42105263, 0.75], [1.63157895, 0.75], [1.84210526, 0.75], [2.05263158, 0.75], [2.26315789, 0.75], [2.47368421, 0.75], [2.68421053, 0.75], [2.89473684, 0.75], [-0.89473684, 0.85], [-0.68421053, 0.85], [-0.47368421, 0.85], [-0.26315789, 0.85], [-0.05263158, 0.85], [0.15789474, 0.85], [0.36842105, 0.85], [0.57894737, 0.85], [0.78947368, 0.85], [1.0, 0.85], [1.21052632, 0.85], [1.42105263, 0.85], [1.63157895, 0.85], [1.84210526, 0.85], [2.05263158, 0.85], [2.26315789, 0.85], [2.47368421, 0.85], [2.68421053, 0.85], [2.89473684, 0.85], [-0.89473684, 0.95], [-0.68421053, 0.95], [-0.47368421, 0.95], [-0.26315789, 0.95], [-0.05263158, 0.95], [0.15789474, 0.95], [0.36842105, 0.95], [0.57894737, 0.95], [0.78947368, 0.95], [1.0, 0.95], [1.21052632, 0.95], [1.42105263, 0.95], [1.63157895, 0.95], [1.84210526, 0.95], [2.05263158, 0.95], [2.26315789, 0.95], [2.47368421, 0.95], [2.68421053, 0.95], [2.89473684, 0.95], [-0.89473684, 1.1], [-0.68421053, 1.1], [-0.47368421, 1.1], [-0.26315789, 1.1], [-0.05263158, 1.1], [0.15789474, 1.1], [0.36842105, 1.1], [0.57894737, 1.1], [0.78947368, 1.1], [1.0, 1.1], [1.21052632, 1.1], [1.42105263, 1.1], [1.63157895, 1.1], [1.84210526, 1.1], [2.05263158, 1.1], [2.26315789, 1.1], [2.47368421, 1.1], [2.68421053, 1.1], [2.89473684, 1.1], [-0.89473684, 1.3], [-0.68421053, 1.3], [-0.47368421, 1.3], [-0.26315789, 1.3], [-0.05263158, 1.3], [0.15789474, 1.3], [0.36842105, 1.3], [0.57894737, 1.3], [0.78947368, 1.3], [1.0, 1.3], [1.21052632, 1.3], [1.42105263, 1.3], [1.63157895, 1.3], [1.84210526, 1.3], [2.05263158, 1.3], [2.26315789, 1.3], [2.47368421, 1.3], [2.68421053, 1.3], [2.89473684, 1.3], [-0.89473684, 1.5], [-0.68421053, 1.5], [-0.47368421, 1.5], [-0.26315789, 1.5], [-0.05263158, 1.5], [0.15789474, 1.5], [0.36842105, 1.5], [0.57894737, 1.5], [0.78947368, 1.5], [1.0, 1.5], [1.21052632, 1.5], [1.42105263, 1.5], [1.63157895, 1.5], [1.84210526, 1.5], [2.05263158, 1.5], [2.26315789, 1.5], [2.47368421, 1.5], [2.68421053, 1.5], [2.89473684, 1.5]])
        
      bin_edges_2d = [
      # bin edges for x0, including both the leftmost and rightmost bin edge locations
      [-1.0, -0.78947368, -0.57894737, -0.36842105, -0.15789474, 0.05263158, 0.26315789, 0.47368421, 0.68421053, 0.89473684, 1.10526316, 1.31578947, 1.52631579, 1.73684211, 1.94736842, 2.15789474, 2.36842105, 2.57894737, 2.78947368, 3.0],
      # bin edges for x1, including both the leftmost and rightmost bin edge locations
      [0, 0.15, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1.0, 1.2, 1.4, 1.6]
      ]

      # bin content in the same order as x
      y=np.array([5.80841135, 5.66442451, 5.67092581, 5.99946465, 6.72334223, 11.8839351, 11.70210389, 10.83160653, 11.05671041, 11.65505484, 11.74977073, 11.37863092, 11.04891891, 10.54443351, 9.85884817, 9.26198068, 9.08346238, 9.01124884, 8.67448045, 5.51642995, 5.7399991, 5.86204003, 5.60075074, 7.12460168, 10.45591606, 11.34577307, 11.83253602, 11.80115663, 11.92143126, 11.98332533, 11.25828175, 11.13023136, 11.0448041, 10.32717692, 9.87007297, 10.33007073, 9.47437583, 9.33825107, 5.87552528, 5.87226917, 5.72407392, 5.99459365, 7.21075706, 9.57999944, 11.14630517, 11.6052531, 12.20383696, 11.33453781, 11.80621707, 11.31355362, 11.04485278, 11.31490029, 10.68133191, 10.18161626, 10.05683147, 9.85443861, 9.52620355, 5.82147825, 5.80449118, 5.63844187, 6.48911637, 7.60877817, 8.87604788, 10.79030596, 11.25448546, 11.73984289, 11.54042128, 11.53108651, 11.77014235, 11.33396207, 11.07519537, 11.19571342, 10.9709825, 10.52073887, 10.78998701, 10.24676479, 5.40030606, 5.97796282, 6.25649514, 6.58593961, 7.12571107, 8.93839847, 10.54214421, 10.91076023, 11.48655234, 11.72277884, 11.36044296, 11.5814517, 10.81553606, 11.37393839, 11.51261109, 11.10538056, 11.53835619, 10.83521735, 10.79516764, 5.76103808, 6.05957763, 5.73345161, 6.93045976, 7.70874758, 8.68025502, 9.90211269, 10.67858906, 10.98456766, 11.24592033, 11.52426219, 11.6804926, 11.73968818, 12.05440218, 11.51011004, 12.15144204, 11.33511877, 11.42029543, 11.62863775, 5.82309015, 5.70233518, 6.18687988, 6.86941477, 7.44651824, 8.77611487, 9.4621706, 9.94369755, 11.03747666, 11.36118742, 11.7133363, 11.79463553, 11.45248231, 11.48968055, 11.92679536, 11.79350837, 11.64662208, 11.66921516, 11.88779862, 5.96080281, 6.19532031, 6.66100621, 7.11673085, 7.93906306, 8.65205942, 9.0672692, 9.90619603, 10.58915112, 11.20612733, 11.41915251, 11.76774314, 11.7698089, 11.64708833, 11.57544731, 11.071521, 11.27764519, 10.06558254, 9.83321735, 6.74386781, 6.85226433, 6.75876726, 7.52738693, 7.76740625, 8.0921833, 9.00932201, 9.41135028, 10.49111133, 10.82817243, 11.18615416, 11.60584065, 11.85012171, 11.21194604, 10.73622112, 10.16814234, 9.25557285, 8.08406331, 7.23654642, 7.16990421, 6.8930864, 7.11595218, 7.394774, 7.86296989, 8.23172581, 8.99027074, 9.20180569, 9.92003726, 10.63651025, 11.13158267, 11.4975352, 11.40471321, 10.91301231, 9.16523291, 7.73576722, 6.79121611, 5.88174515, 5.8742713, 7.74862464, 7.34760779, 7.53062726, 7.71586872, 7.9387384, 7.97935795, 8.36479935, 8.80446465, 9.61325079, 10.36513735, 11.51424305, 11.61080369, 11.54216016, 9.31600183, 7.45511379, 5.79114212, 5.62415307, 5.57120758, 5.37471341, 7.72439334, 7.61811624, 7.7787156, 7.86881202, 8.33080852, 8.17588793, 8.18102946, 8.44622712, 9.16084102, 9.62534026, 11.19359533, 11.91121198, 10.74212391, 7.51410687, 6.1778789, 5.74659241, 6.01959324, 5.11988353, 5.63018625])

      y_up=np.array([0.58084114, 0.56644245, 0.56709258, 0.59994646, 0.67233422, 1.18839351, 1.17021039, 1.08316065, 1.10567104, 1.16550548, 1.17497707, 1.13786309, 1.10489189, 1.05444335, 0.98588482, 0.92619807, 0.90834624, 0.90112488, 0.86744805, 0.55164299, 0.57399991, 0.586204, 0.56007507, 0.71246017, 1.04559161, 1.13457731, 1.1832536, 1.18011566, 1.19214313, 1.19833253, 1.12582818, 1.11302314, 1.10448041, 1.03271769, 0.9870073, 1.03300707, 0.94743758, 0.93382511, 0.58755253, 0.58722692, 0.57240739, 0.59945936, 0.72107571, 0.95799994, 1.11463052, 1.16052531, 1.2203837, 1.13345378, 1.18062171, 1.13135536, 1.10448528, 1.13149003, 1.06813319, 1.01816163, 1.00568315, 0.98544386, 0.95262036, 0.58214782, 0.58044912, 0.56384419, 0.64891164, 0.76087782, 0.88760479, 1.0790306, 1.12544855, 1.17398429, 1.15404213, 1.15310865, 1.17701424, 1.13339621, 1.10751954, 1.11957134, 1.09709825, 1.05207389, 1.0789987, 1.02467648, 0.54003061, 0.59779628, 0.62564951, 0.65859396, 0.71257111, 0.89383985, 1.05421442, 1.09107602, 1.14865523, 1.17227788, 1.1360443, 1.15814517, 1.08155361, 1.13739384, 1.15126111, 1.11053806, 1.15383562, 1.08352173, 1.07951676, 0.57610381, 0.60595776, 0.57334516, 0.69304598, 0.77087476, 0.8680255, 0.99021127, 1.06785891, 1.09845677, 1.12459203, 1.15242622, 1.16804926, 1.17396882, 1.20544022, 1.151011, 1.2151442, 1.13351188, 1.14202954, 1.16286378, 0.58230901, 0.57023352, 0.61868799, 0.68694148, 0.74465182, 0.87761149, 0.94621706, 0.99436975, 1.10374767, 1.13611874, 1.17133363, 1.17946355, 1.14524823, 1.14896806, 1.19267954, 1.17935084, 1.16466221, 1.16692152, 1.18877986, 0.59608028, 0.61953203, 0.66610062, 0.71167308, 0.79390631, 0.86520594, 0.90672692, 0.9906196, 1.05891511, 1.12061273, 1.14191525, 1.17677431, 1.17698089, 1.16470883, 1.15754473, 1.1071521, 1.12776452, 1.00655825, 0.98332174, 0.67438678, 0.68522643, 0.67587673, 0.75273869, 0.77674062, 0.80921833, 0.9009322, 0.94113503, 1.04911113, 1.08281724, 1.11861542, 1.16058406, 1.18501217, 1.1211946, 1.07362211, 1.01681423, 0.92555728, 0.80840633, 0.72365464, 0.71699042, 0.68930864, 0.71159522, 0.7394774, 0.78629699, 0.82317258, 0.89902707, 0.92018057, 0.99200373, 1.06365103, 1.11315827, 1.14975352, 1.14047132, 1.09130123, 0.91652329, 0.77357672, 0.67912161, 0.58817452, 0.58742713, 0.77486246, 0.73476078, 0.75306273, 0.77158687, 0.79387384, 0.7979358, 0.83647994, 0.88044646, 0.96132508, 1.03651373, 1.15142431, 1.16108037, 1.15421602, 0.93160018, 0.74551138, 0.57911421, 0.56241531, 0.55712076, 0.53747134, 0.77243933, 0.76181162, 0.77787156, 0.7868812, 0.83308085, 0.81758879, 0.81810295, 0.84462271, 0.9160841, 0.96253403, 1.11935953, 1.1911212, 1.07421239, 0.75141069, 0.61778789, 0.57465924, 0.60195932, 0.51198835, 0.56301862])

      y_down=np.array([0.58084114, 0.56644245, 0.56709258, 0.59994646, 0.67233422, 1.18839351, 1.17021039, 1.08316065, 1.10567104, 1.16550548, 1.17497707, 1.13786309, 1.10489189, 1.05444335, 0.98588482, 0.92619807, 0.90834624, 0.90112488, 0.86744805, 0.55164299, 0.57399991, 0.586204, 0.56007507, 0.71246017, 1.04559161, 1.13457731, 1.1832536, 1.18011566, 1.19214313, 1.19833253, 1.12582818, 1.11302314, 1.10448041, 1.03271769, 0.9870073, 1.03300707, 0.94743758, 0.93382511, 0.58755253, 0.58722692, 0.57240739, 0.59945936, 0.72107571, 0.95799994, 1.11463052, 1.16052531, 1.2203837, 1.13345378, 1.18062171, 1.13135536, 1.10448528, 1.13149003, 1.06813319, 1.01816163, 1.00568315, 0.98544386, 0.95262036, 0.58214782, 0.58044912, 0.56384419, 0.64891164, 0.76087782, 0.88760479, 1.0790306, 1.12544855, 1.17398429, 1.15404213, 1.15310865, 1.17701424, 1.13339621, 1.10751954, 1.11957134, 1.09709825, 1.05207389, 1.0789987, 1.02467648, 0.54003061, 0.59779628, 0.62564951, 0.65859396, 0.71257111, 0.89383985, 1.05421442, 1.09107602, 1.14865523, 1.17227788, 1.1360443, 1.15814517, 1.08155361, 1.13739384, 1.15126111, 1.11053806, 1.15383562, 1.08352173, 1.07951676, 0.57610381, 0.60595776, 0.57334516, 0.69304598, 0.77087476, 0.8680255, 0.99021127, 1.06785891, 1.09845677, 1.12459203, 1.15242622, 1.16804926, 1.17396882, 1.20544022, 1.151011, 1.2151442, 1.13351188, 1.14202954, 1.16286378, 0.58230901, 0.57023352, 0.61868799, 0.68694148, 0.74465182, 0.87761149, 0.94621706, 0.99436975, 1.10374767, 1.13611874, 1.17133363, 1.17946355, 1.14524823, 1.14896806, 1.19267954, 1.17935084, 1.16466221, 1.16692152, 1.18877986, 0.59608028, 0.61953203, 0.66610062, 0.71167308, 0.79390631, 0.86520594, 0.90672692, 0.9906196, 1.05891511, 1.12061273, 1.14191525, 1.17677431, 1.17698089, 1.16470883, 1.15754473, 1.1071521, 1.12776452, 1.00655825, 0.98332174, 0.67438678, 0.68522643, 0.67587673, 0.75273869, 0.77674062, 0.80921833, 0.9009322, 0.94113503, 1.04911113, 1.08281724, 1.11861542, 1.16058406, 1.18501217, 1.1211946, 1.07362211, 1.01681423, 0.92555728, 0.80840633, 0.72365464, 0.71699042, 0.68930864, 0.71159522, 0.7394774, 0.78629699, 0.82317258, 0.89902707, 0.92018057, 0.99200373, 1.06365103, 1.11315827, 1.14975352, 1.14047132, 1.09130123, 0.91652329, 0.77357672, 0.67912161, 0.58817452, 0.58742713, 0.77486246, 0.73476078, 0.75306273, 0.77158687, 0.79387384, 0.7979358, 0.83647994, 0.88044646, 0.96132508, 1.03651373, 1.15142431, 1.16108037, 1.15421602, 0.93160018, 0.74551138, 0.57911421, 0.56241531, 0.55712076, 0.53747134, 0.77243933, 0.76181162, 0.77787156, 0.7868812, 0.83308085, 0.81758879, 0.81810295, 0.84462271, 0.9160841, 0.96253403, 1.11935953, 1.1911212, 1.07421239, 0.75141069, 0.61778789, 0.57465924, 0.60195932, 0.51198835, 0.56301862])

.. container:: cell code
   :name: 6a009058-5384-4988-a12b-d6ac1bf7bd44

   .. code:: python

      from pysr import PySRRegressor
      import sympy

      pysr_config = PySRRegressor(
          model_selection = 'accuracy',
          niterations = 200,
          maxsize = 60,
          binary_operators = [
              '+', '*'
                           ],
          unary_operators = [
              'exp',
              'gauss(x) = exp(-x*x)',
              'tanh',
          ],
          nested_constraints = {
              'tanh':   {'tanh': 0, 'exp': 0, 'gauss': 0, '*': 2},
              'exp':    {'tanh': 0, 'exp': 0, 'gauss': 0, '*': 2},
              'gauss':  {'tanh': 0, 'exp': 0, 'gauss': 0, '*': 2},
              '*':      {'tanh': 1, 'exp': 1, 'gauss': 1, '*': 2},
          },
          extra_sympy_mappings={
              'gauss': lambda x: sympy.exp(-x*x),
                               },
          loss='loss(y, y_pred, weights) = (y - y_pred)^2 * weights',
      )

.. container:: cell code
   :name: 3fc09f89-45a9-43b3-b697-8bc7f642afb3

   .. code:: python

      from symbolfit.symbolfit import *

      model = SymbolFit(
              x = x,
              y = y,
              y_up = y_up,
              y_down = y_down,
              pysr_config = pysr_config,
              max_complexity = 60,
              input_rescale = False,
              scale_y_by = None,
              max_stderr = 20,
              fit_y_unc = True,
              random_seed = seed,
              loss_weights = None
      )

      model.fit()

.. container:: cell code
   :name: 308e679d-3e10-43a8-a018-3243abc4971a

   .. code:: python

      model.save_to_csv(output_dir = 'toy_dataset_3c/')

.. container:: cell code
   :name: f045a847-e5df-4f68-97b0-33e064eaf3bb

   .. code:: python

      model.plot_to_pdf(
          	output_dir = 'toy_dataset_3c/',
          	#bin_widths_1d = bin_widths_1d,
          	bin_edges_2d = bin_edges_2d,
          	plot_logy = False,
          	plot_logx = False,
              sampling_95quantile = False
      )

.. container:: cell code
   :name: 721ed6d7-5692-441d-ad87-d94b09e7f978

   .. code:: python
